goog.provide('transplants.results');
/**
 * Display results.
 * TODO: REMOVE HARD_CODED TOOL KEYWORDS AND TEXTS
 */
transplants.results.results_panel = (function transplants$results$results_panel(organ,centre,tool){
var day = cljs.core.deref(re_frame.core.subscribe.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("transplants.subs","test-day","transplants.subs/test-day",437848619)], null)));
var map__69132 = transplants.bundles.get_bundle(organ,centre,tool);
var map__69132__$1 = cljs.core.__destructure_map(map__69132);
var bundle = map__69132__$1;
var fmaps = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__69132__$1,new cljs.core.Keyword(null,"fmaps","fmaps",-1655984758));
var outcome_keys = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__69132__$1,new cljs.core.Keyword(null,"outcome-keys","outcome-keys",-2047325332));
var base_outcome_keys = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__69132__$1,new cljs.core.Keyword(null,"base-outcome-keys","base-outcome-keys",519744091));
var timed_outcome_keys = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__69132__$1,new cljs.core.Keyword(null,"timed-outcome-keys","timed-outcome-keys",-304514980));
var beta_keys = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__69132__$1,new cljs.core.Keyword(null,"beta-keys","beta-keys",-1150961314));
var outcomes = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__69132__$1,new cljs.core.Keyword(null,"outcomes","outcomes",-2034044865));
var S0 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__69132__$1,new cljs.core.Keyword(null,"S0","S0",-1501768316));
var all_S0 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__69132__$1,new cljs.core.Keyword(null,"all-S0","all-S0",2021249433));
var env = cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"day","day",-274800446),new cljs.core.Keyword(null,"S0","S0",-1501768316),new cljs.core.Keyword(null,"cohort-dates","cohort-dates",-862256444),new cljs.core.Keyword(null,"fmaps","fmaps",-1655984758),new cljs.core.Keyword(null,"tool","tool",-1298696470),new cljs.core.Keyword(null,"bundle","bundle",-1741503734),new cljs.core.Keyword(null,"outcome-keys","outcome-keys",-2047325332),new cljs.core.Keyword(null,"inputs","inputs",865803858),new cljs.core.Keyword(null,"organ","organ",-29862572),new cljs.core.Keyword(null,"mdata","mdata",-2098476679),new cljs.core.Keyword(null,"all-S0","all-S0",2021249433),new cljs.core.Keyword(null,"base-outcome-keys","base-outcome-keys",519744091),new cljs.core.Keyword(null,"timed-outcome-keys","timed-outcome-keys",-304514980),new cljs.core.Keyword(null,"selected-vis","selected-vis",624123356),new cljs.core.Keyword(null,"beta-keys","beta-keys",-1150961314),new cljs.core.Keyword(null,"centre","centre",-948091970),new cljs.core.Keyword(null,"outcomes","outcomes",-2034044865)],[day,S0,cljs.core.deref(re_frame.core.subscribe.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("transplants.subs","cohort-dates","transplants.subs/cohort-dates",1267859601)], null))),fmaps,tool,bundle,outcome_keys,cljs.core.get.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(re_frame.core.subscribe.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("transplants.subs","inputs","transplants.subs/inputs",-1197335133)], null))),organ),organ,cljs.core.deref(re_frame.core.subscribe.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("transplants.subs","mdata","transplants.subs/mdata",-3881910)], null))),all_S0,base_outcome_keys,timed_outcome_keys,cljs.core.deref(re_frame.core.subscribe.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("transplants.subs","selected-vis","transplants.subs/selected-vis",-1611164277)], null))),beta_keys,centre,outcomes]);
var s0 = all_S0;
var s0_for_day = transplants.model.S0_for_day(s0,day);
var cox_QMARK_ = transplants.model.use_cox_adjusted_QMARK_(tool);
var sum_betas = cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__69128_SHARP_){
return transplants.factors.sum_beta_xs(env,p1__69128_SHARP_);
}),beta_keys);
var F = transplants.model.cox_adjusted(s0,sum_betas);
var env__$1 = cljs.core.conj.cljs$core$IFn$_invoke$arity$variadic(env,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"sum-betas","sum-betas",-2024666066),sum_betas], null),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"s0","s0",-350711836),s0], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"s0-for-day","s0-for-day",1308618702),s0_for_day], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"cox?","cox?",-1619755638),cox_QMARK_], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"F","F",-1115543258),F], null)], 0));
var inputs = new cljs.core.Keyword(null,"inputs","inputs",865803858).cljs$core$IFn$_invoke$arity$1(env__$1);
var required_inputs = cljs.core.keys(fmaps);
var fulfilled_inputs = cljs.core.select_keys(inputs,required_inputs);
var missing = (cljs.core.count(fulfilled_inputs) < cljs.core.count(required_inputs));
var unknowns = cljs.core.some((function (p1__69129_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.get.cljs$core$IFn$_invoke$arity$2(inputs,p1__69129_SHARP_),new cljs.core.Keyword(null,"unknown","unknown",-935977881));
}),required_inputs);
var overlay = ((missing)?new cljs.core.Keyword(null,"missing","missing",362507769):(cljs.core.truth_(unknowns)?new cljs.core.Keyword(null,"unknowns","unknowns",-456821575):null));
return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"style","style",-496642736),new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(null,"background-color","background-color",570434026),"#fff",new cljs.core.Keyword(null,"border","border",1444987323),["3px solid ",(function (){var pred__69137 = cljs.core._EQ_;
var expr__69138 = overlay;
if(cljs.core.truth_((pred__69137.cljs$core$IFn$_invoke$arity$2 ? pred__69137.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"missing","missing",362507769),expr__69138) : pred__69137.call(null,new cljs.core.Keyword(null,"missing","missing",362507769),expr__69138)))){
return "rgb(255,0,0)";
} else {
if(cljs.core.truth_((pred__69137.cljs$core$IFn$_invoke$arity$2 ? pred__69137.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"unknowns","unknowns",-456821575),expr__69138) : pred__69137.call(null,new cljs.core.Keyword(null,"unknowns","unknowns",-456821575),expr__69138)))){
return "teal";
} else {
if(cljs.core.truth_((pred__69137.cljs$core$IFn$_invoke$arity$2 ? pred__69137.cljs$core$IFn$_invoke$arity$2(null,expr__69138) : pred__69137.call(null,null,expr__69138)))){
return "#CCC";
} else {
throw (new Error(["No matching clause: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(expr__69138)].join('')));
}
}
}
})()].join(''),new cljs.core.Keyword(null,"border-radius","border-radius",419594011),(5),new cljs.core.Keyword(null,"margin-top","margin-top",392161226),(30),new cljs.core.Keyword(null,"margin-bottom","margin-bottom",388334941),(20),new cljs.core.Keyword(null,"padding","padding",1660304693),"20px 5px 5px 15px",new cljs.core.Keyword(null,"position","position",-2011731912),"relative"], null)], null),(function (){var pred__69140 = cljs.core._EQ_;
var expr__69141 = overlay;
if(cljs.core.truth_((pred__69140.cljs$core$IFn$_invoke$arity$2 ? pred__69140.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"missing","missing",362507769),expr__69141) : pred__69140.call(null,new cljs.core.Keyword(null,"missing","missing",362507769),expr__69141)))){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"<>","<>",1280186386),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"style","style",-496642736),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"color","color",1011675173),new cljs.core.Keyword(null,"top","top",-1856271961),new cljs.core.Keyword(null,"background-color","background-color",570434026),new cljs.core.Keyword(null,"z-index","z-index",1892827090),new cljs.core.Keyword(null,"padding","padding",1660304693),new cljs.core.Keyword(null,"right","right",-452581833),new cljs.core.Keyword(null,"position","position",-2011731912),new cljs.core.Keyword(null,"border","border",1444987323),new cljs.core.Keyword(null,"border-radius","border-radius",419594011)],["rgb(255,0,0)","-20px","#fec",(1000),"2px 5px","20px","absolute","3px solid rgb(255,0,0)",(5)])], null),"Warning: some inputs are missing"], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"style","style",-496642736),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"align-items","align-items",-267946462),new cljs.core.Keyword(null,"bottom","bottom",-1550509018),new cljs.core.Keyword(null,"top","top",-1856271961),new cljs.core.Keyword(null,"background-color","background-color",570434026),new cljs.core.Keyword(null,"z-index","z-index",1892827090),new cljs.core.Keyword(null,"padding","padding",1660304693),new cljs.core.Keyword(null,"justify-content","justify-content",-1990475787),new cljs.core.Keyword(null,"right","right",-452581833),new cljs.core.Keyword(null,"display","display",242065432),new cljs.core.Keyword(null,"position","position",-2011731912),new cljs.core.Keyword(null,"left","left",-399115937)],["center",(0),(0),transplants.rgb.theme,(500),(0),"center",(0),"flex","absolute",(0)])], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"flex","flex",-1425124628),"auto",new cljs.core.Keyword(null,"style","style",-496642736),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"color","color",1011675173),"#fff",new cljs.core.Keyword(null,"text-align","text-align",1786091845),"center",new cljs.core.Keyword(null,"width","width",-384071477),(400)], null)], null),"Results will appear here once all inputs have been entered."], null)], null)], null);
} else {
if(cljs.core.truth_((pred__69140.cljs$core$IFn$_invoke$arity$2 ? pred__69140.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"unknowns","unknowns",-456821575),expr__69141) : pred__69140.call(null,new cljs.core.Keyword(null,"unknowns","unknowns",-456821575),expr__69141)))){
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"<>","<>",1280186386),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"style","style",-496642736),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"color","color",1011675173),new cljs.core.Keyword(null,"top","top",-1856271961),new cljs.core.Keyword(null,"background-color","background-color",570434026),new cljs.core.Keyword(null,"z-index","z-index",1892827090),new cljs.core.Keyword(null,"padding","padding",1660304693),new cljs.core.Keyword(null,"right","right",-452581833),new cljs.core.Keyword(null,"position","position",-2011731912),new cljs.core.Keyword(null,"border","border",1444987323),new cljs.core.Keyword(null,"border-radius","border-radius",419594011)],["teal","-20px","#fec",(1000),"2px 5px","20px","absolute","3px solid teal",(5)])], null),"Average values were used for some inputs"], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"style","style",-496642736),cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"bottom","bottom",-1550509018),new cljs.core.Keyword(null,"top","top",-1856271961),new cljs.core.Keyword(null,"background-color","background-color",570434026),new cljs.core.Keyword(null,"z-index","z-index",1892827090),new cljs.core.Keyword(null,"padding","padding",1660304693),new cljs.core.Keyword(null,"right","right",-452581833),new cljs.core.Keyword(null,"position","position",-2011731912),new cljs.core.Keyword(null,"pointer-events","pointer-events",-1053858853),new cljs.core.Keyword(null,"left","left",-399115937)],[(0),(0),"#fec2",(500),(0),(0),"absolute","none",(0)])], null)], null)], null);
} else {
if(cljs.core.truth_((pred__69140.cljs$core$IFn$_invoke$arity$2 ? pred__69140.cljs$core$IFn$_invoke$arity$2(null,expr__69141) : pred__69140.call(null,null,expr__69141)))){
return null;
} else {
throw (new Error(["No matching clause: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(expr__69141)].join('')));
}
}
}
})(),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"section","section",-300141526),new cljs.core.PersistentVector(null, 7, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.ui.tabs,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"variant","variant",-424354234),"pills",new cljs.core.Keyword(null,"default-active-key","default-active-key",-2029119968),new cljs.core.Keyword(null,"selected-vis","selected-vis",624123356).cljs$core$IFn$_invoke$arity$1(env__$1),new cljs.core.Keyword(null,"active-key","active-key",-2039404654),new cljs.core.Keyword(null,"selected-vis","selected-vis",624123356).cljs$core$IFn$_invoke$arity$1(env__$1),new cljs.core.Keyword(null,"on-select","on-select",-192407950),(function (p1__69131_SHARP_){
return re_frame.core.dispatch(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("transplants.events","selected-vis","transplants.events/selected-vis",368577841),p1__69131_SHARP_], null));
})], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.ui.tab,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"event-key","event-key",2089664830),"bars",new cljs.core.Keyword(null,"title","title",636505583),"Bar Chart"], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.vis2.bar_chart,env__$1], null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.ui.tab,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"event-key","event-key",2089664830),"area",new cljs.core.Keyword(null,"title","title",636505583),"Area Chart"], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.vis2.area_chart,env__$1], null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.ui.tab,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"event-key","event-key",2089664830),"icons",new cljs.core.Keyword(null,"title","title",636505583),"Icon Array"], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.vis2.icon_array,env__$1], null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.ui.tab,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"event-key","event-key",2089664830),"table",new cljs.core.Keyword(null,"title","title",636505583),"Table"], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.vis2.table,env__$1], null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.ui.tab,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"event-key","event-key",2089664830),"text",new cljs.core.Keyword(null,"title","title",636505583),"Text"], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [transplants.vis2.text,env__$1], null)], null)], null)], null)], null);
});

//# sourceMappingURL=transplants.results.js.map
